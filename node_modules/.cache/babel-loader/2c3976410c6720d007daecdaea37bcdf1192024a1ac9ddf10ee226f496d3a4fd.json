{"ast":null,"code":"// pages/CourseList.jsx\nimport React,{useEffect,useState,useContext}from'react';import{Link}from'react-router-dom';import{AuthContext}from'../App';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CourseList=()=>{const[courses,setCourses]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const{supabase,session}=useContext(AuthContext);const[userRole,setUserRole]=useState(null);useEffect(()=>{const fetchCourses=async()=>{try{const{data,error}=await supabase.from('courses').select('*').order('created_at',{ascending:false});if(error)throw error;setCourses(data||[]);}catch(error){setError('Error fetching courses');console.error(error);}finally{setLoading(false);}};const fetchUserRole=async()=>{if(session!==null&&session!==void 0&&session.user){try{const{data,error}=await supabase.from('profiles').select('role').eq('id',session.user.id).single();if(error)throw error;setUserRole(data===null||data===void 0?void 0:data.role);}catch(error){console.error('Error fetching user role:',error);}}};fetchCourses();fetchUserRole();},[supabase,session]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\",children:error});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold\",children:\"Courses\"}),userRole==='admin'||userRole==='instructor'?/*#__PURE__*/_jsx(Link,{to:\"/course/new\",className:\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\",children:\"Create New Course\"}):null]}),courses.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No courses available yet.\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",children:courses.map(course=>/*#__PURE__*/_jsxs(Link,{to:`/course/${course.id}`,className:\"block bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-48 bg-gray-200 relative overflow-hidden\",children:course.cover_image?/*#__PURE__*/_jsx(\"img\",{src:course.cover_image,alt:course.title,className:\"w-full h-full object-cover\"}):/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full bg-gray-200 text-gray-400\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-12 h-12\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"})})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-2\",children:course.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-2 line-clamp-2\",children:course.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-4\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-500 font-medium\",children:[course.lessons_count||0,\" lessons\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full\",children:course.level||'All Levels'})]})]})]},course.id))})]});};export default CourseList;","map":{"version":3,"names":["React","useEffect","useState","useContext","Link","AuthContext","jsx","_jsx","jsxs","_jsxs","CourseList","courses","setCourses","loading","setLoading","error","setError","supabase","session","userRole","setUserRole","fetchCourses","data","from","select","order","ascending","console","fetchUserRole","user","eq","id","single","role","className","children","to","length","map","course","cover_image","src","alt","title","fill","stroke","viewBox","xmlns","strokeLinecap","strokeLinejoin","strokeWidth","d","description","lessons_count","level"],"sources":["/workspaces/BringSpeech/src/pages/CourseList.jsx"],"sourcesContent":["// pages/CourseList.jsx\nimport React, { useEffect, useState, useContext } from 'react';\nimport { Link } from 'react-router-dom';\nimport { AuthContext } from '../App';\n\nconst CourseList = () => {\n  const [courses, setCourses] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const { supabase, session } = useContext(AuthContext);\n  const [userRole, setUserRole] = useState(null);\n\n  useEffect(() => {\n    const fetchCourses = async () => {\n      try {\n        const { data, error } = await supabase\n          .from('courses')\n          .select('*')\n          .order('created_at', { ascending: false });\n\n        if (error) throw error;\n        setCourses(data || []);\n      } catch (error) {\n        setError('Error fetching courses');\n        console.error(error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    const fetchUserRole = async () => {\n      if (session?.user) {\n        try {\n          const { data, error } = await supabase\n            .from('profiles')\n            .select('role')\n            .eq('id', session.user.id)\n            .single();\n\n          if (error) throw error;\n          setUserRole(data?.role);\n        } catch (error) {\n          console.error('Error fetching user role:', error);\n        }\n      }\n    };\n\n    fetchCourses();\n    fetchUserRole();\n  }, [supabase, session]);\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n        {error}\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-3xl font-bold\">Courses</h1>\n        {userRole === 'admin' || userRole === 'instructor' ? (\n          <Link\n            to=\"/course/new\"\n            className=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\n          >\n            Create New Course\n          </Link>\n        ) : null}\n      </div>\n\n      {courses.length === 0 ? (\n        <div className=\"text-center py-8\">\n          <p className=\"text-gray-500\">No courses available yet.</p>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {courses.map((course) => (\n            <Link\n              to={`/course/${course.id}`}\n              key={course.id}\n              className=\"block bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300\"\n            >\n              <div className=\"h-48 bg-gray-200 relative overflow-hidden\">\n                {course.cover_image ? (\n                  <img\n                    src={course.cover_image}\n                    alt={course.title}\n                    className=\"w-full h-full object-cover\"\n                  />\n                ) : (\n                  <div className=\"flex items-center justify-center h-full bg-gray-200 text-gray-400\">\n                    <svg className=\"w-12 h-12\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"></path>\n                    </svg>\n                  </div>\n                )}\n              </div>\n              <div className=\"p-4\">\n                <h2 className=\"text-xl font-semibold mb-2\">{course.title}</h2>\n                <p className=\"text-gray-600 mb-2 line-clamp-2\">{course.description}</p>\n                <div className=\"flex justify-between items-center mt-4\">\n                  <span className=\"text-blue-500 font-medium\">{course.lessons_count || 0} lessons</span>\n                  <span className=\"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full\">\n                    {course.level || 'All Levels'}\n                  </span>\n                </div>\n              </div>\n            </Link>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CourseList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}